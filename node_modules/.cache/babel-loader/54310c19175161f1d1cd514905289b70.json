{"ast":null,"code":"import _toConsumableArray from\"D:\\\\React_SN\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"D:\\\\React_SN\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import{usersAPI}from\"../api/api\";var FOLLOW='FOLLOW';var UNFOLLOW='UNFOLLOW';var SET_USERS='SET_USERS';var SET_CURRENT_PAGE='SET_CURRENT_PAGE';var SET_TOTAL_USERS_COUNT='SET_TOTAL_USERS_COUNT';var TOGGLE_IS_FETCHING='TOGGLE_IS_FETCHING';var TOGGLE_IS_FOLLOWING_PROGRESS='TOGGLE_IS_FOLLOWING_PROGRESS';var initialState={users:[],pageSize:25,totalUsersCount:0,currentPage:2,isFetching:true,followingProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread({},state,{// users: [...state.users]\nusers:state.users.map(function(u){if(u.id===action.userId){return _objectSpread({},u,{followed:true});}return u;})});case UNFOLLOW:return _objectSpread({},state,{// users: [...state.users]\nusers:state.users.map(function(u){if(u.id===action.userId){return _objectSpread({},u,{followed:false});}return u;})});case SET_USERS:return _objectSpread({},state,{users:action.users});case SET_CURRENT_PAGE:return _objectSpread({},state,{currentPage:action.currentPage});case SET_TOTAL_USERS_COUNT:return _objectSpread({},state,{totalUsersCount:action.count});case TOGGLE_IS_FETCHING:return _objectSpread({},state,{isFetching:action.isFetching});case TOGGLE_IS_FOLLOWING_PROGRESS:return _objectSpread({},state,{followingProgress:action.isFetching?[].concat(_toConsumableArray(state.followingProgress),[action.userId]):state.followingProgress.filter(function(id){return id!=action.userId;})});default:return state;}};export var followSuccess=function followSuccess(userId){return{type:FOLLOW,userId:userId};};export var unfollowSuccess=function unfollowSuccess(userId){return{type:UNFOLLOW,userId:userId};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var setCurrentPage=function setCurrentPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var setTotalUsersCount=function setTotalUsersCount(totalUsersCount){return{type:SET_TOTAL_USERS_COUNT,count:totalUsersCount};};export var setFetching=function setFetching(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var setFollowingProgress=function setFollowingProgress(isFetching,userId){return{type:TOGGLE_IS_FOLLOWING_PROGRESS,isFetching:isFetching,userId:userId};};export var getUsers=function getUsers(currentPage,pageSize){return function(dispatch){dispatch(setFetching(true));usersAPI.getUsers(currentPage,pageSize).then(function(data){dispatch(setFetching(false));dispatch(setUsers(data.items));dispatch(setTotalUsersCount(data.totalCount));});};};export var follow=function follow(userId){return function(dispatch){dispatch(setFollowingProgress(true,userId));usersAPI.follow(userId).then(function(response){if(response.resultCode===0){dispatch(followSuccess(userId));}dispatch(setFollowingProgress(false,userId));});};};export var unfollow=function unfollow(userId){return function(dispatch){dispatch(setFollowingProgress(true,userId));usersAPI.unfollow(userId).then(function(response){if(response.resultCode===0){dispatch(unfollowSuccess(userId));}dispatch(setFollowingProgress(false,userId));});};};export default usersReducer;","map":{"version":3,"sources":["D:/React_SN/src/Redux/usersReducer.jsx"],"names":["usersAPI","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USERS_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLOWING_PROGRESS","initialState","users","pageSize","totalUsersCount","currentPage","isFetching","followingProgress","usersReducer","state","action","type","map","u","id","userId","followed","count","filter","followSuccess","unfollowSuccess","setUsers","setCurrentPage","setTotalUsersCount","setFetching","setFollowingProgress","getUsers","dispatch","then","data","items","totalCount","follow","response","resultCode","unfollow"],"mappings":"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","sourcesContent":["import {usersAPI} from \"../api/api\";\r\n\r\nlet FOLLOW = 'FOLLOW';\r\nlet UNFOLLOW = 'UNFOLLOW';\r\nlet SET_USERS = 'SET_USERS';\r\nlet SET_CURRENT_PAGE = 'SET_CURRENT_PAGE';\r\nlet SET_TOTAL_USERS_COUNT = 'SET_TOTAL_USERS_COUNT';\r\nlet TOGGLE_IS_FETCHING = 'TOGGLE_IS_FETCHING';\r\nlet TOGGLE_IS_FOLLOWING_PROGRESS = 'TOGGLE_IS_FOLLOWING_PROGRESS';\r\n\r\nlet initialState = {\r\n    users: [],\r\n    pageSize: 25,\r\n    totalUsersCount: 0,\r\n    currentPage: 2,\r\n    isFetching: true,\r\n    followingProgress: [],\r\n}\r\n\r\nconst usersReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case FOLLOW:\r\n            return {\r\n                ...state,\r\n                // users: [...state.users]\r\n                users: state.users.map(u => {\r\n                    if (u.id === action.userId) {\r\n                        return {...u, followed: true}\r\n                    }\r\n                    return u;\r\n                })\r\n            }\r\n\r\n        case UNFOLLOW:\r\n            return {\r\n                ...state,\r\n                // users: [...state.users]\r\n                users: state.users.map(u => {\r\n                    if (u.id === action.userId) {\r\n                        return {...u, followed: false}\r\n                    }\r\n                    return u;\r\n                })\r\n            }\r\n        case SET_USERS:\r\n            return {...state, users: action.users};\r\n\r\n        case SET_CURRENT_PAGE:\r\n            return {...state, currentPage: action.currentPage};\r\n            case SET_TOTAL_USERS_COUNT:\r\n            return {...state, totalUsersCount: action.count};\r\n            case TOGGLE_IS_FETCHING:\r\n            return {\r\n                ...state, isFetching: action.isFetching};\r\n        case TOGGLE_IS_FOLLOWING_PROGRESS:\r\n            return {...state, followingProgress: action.isFetching\r\n                    ? [...state.followingProgress, action.userId]\r\n                    : state.followingProgress.filter(id => id != action.userId)\r\n            };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport const followSuccess = (userId) => ({type: FOLLOW, userId});\r\nexport const unfollowSuccess = (userId) => ({type: UNFOLLOW, userId});\r\nexport const setUsers = (users) => ({type: SET_USERS, users});\r\nexport const setCurrentPage = (currentPage) => ({type: SET_CURRENT_PAGE, currentPage});\r\nexport const setTotalUsersCount = (totalUsersCount) => ({type: SET_TOTAL_USERS_COUNT, count: totalUsersCount});\r\nexport const setFetching = (isFetching) => ({type: TOGGLE_IS_FETCHING, isFetching});\r\nexport const setFollowingProgress = (isFetching, userId) => ({type: TOGGLE_IS_FOLLOWING_PROGRESS, isFetching, userId});\r\n\r\nexport const getUsers = (currentPage, pageSize) => {\r\n  return  (dispatch)=> {\r\n   dispatch(setFetching(true));\r\n    usersAPI.getUsers(currentPage, pageSize).then(data => {\r\n        dispatch(setFetching(false));\r\n        dispatch(setUsers(data.items));\r\n        dispatch(setTotalUsersCount(data.totalCount));\r\n    });\r\n}}\r\nexport const follow = (userId) => {\r\n  return  (dispatch)=> {\r\n      dispatch(setFollowingProgress(true, userId));\r\n      usersAPI.follow(userId)\r\n          .then(response => {\r\n              if (response.resultCode === 0) {\r\n                  dispatch(followSuccess(userId))\r\n              }\r\n              dispatch(setFollowingProgress(false, userId));\r\n          })\r\n}}\r\nexport const unfollow = (userId) => {\r\n  return  (dispatch)=> {\r\n      dispatch(setFollowingProgress(true, userId));\r\n      usersAPI.unfollow(userId)\r\n          .then(response => {\r\n              if (response.resultCode === 0) {\r\n                  dispatch(unfollowSuccess(userId))\r\n              }\r\n              dispatch(setFollowingProgress(false, userId));\r\n          })\r\n}}\r\n\r\nexport default usersReducer;"]},"metadata":{},"sourceType":"module"}